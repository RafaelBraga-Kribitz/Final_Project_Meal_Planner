{% extends 'base.html.twig' %}

{% block title %}
    {% if is_authenticated %}
        Welcome Back
    {% else %}
        NextMeal
    {% endif %}
{% endblock %}

{% block body %}
    {% if is_authenticated %}
        <div class="container mt-4">
            <h1 class="welcome-heading">
                Welcome back, {{ app.user.firstName ?? app.user.username ?? 'there' }}! ðŸ‘‹
            </h1>

            {# Featured Recipe Section #}
            <section class="featured-recipe mt-4">
                <h2 class="section-heading">Featured recipe</h2>
                <div class="featured-recipe-card">
                    <img src="{{ asset('pictures/Featured_Recipe_Banner.png') }}" alt="Featured Recipe Banner" class="featured-banner">
                    <div class="featured-content">
                        <h2>Welcome to NextMeal</h2>
                        <p>We help you plan your meals and make grocery shopping easy.</p>
                        <a href="#" class="btn btn-primary get-started-btn">Get Started</a>
                    </div>
                </div>
            </section>

            {# Meal Plans Section #}
            <section class="meal-plans mt-5">
                <h2 class="section-heading">Your meal plans</h2>
                <div class="recipe-grid">
                    {% for recipe in featured_recipes|default([]) %}
                        <div class="recipe-card">
                            <img src="{{ asset('pictures/' ~ recipe.photo) }}" alt="{{ recipe.name }}" class="recipe-image">
                            <div class="recipe-info">
                                <span class="recipe-type">{{ recipe.type|upper }}</span>
                                <h3 class="recipe-title">{{ recipe.name }}</h3>
                                <div class="recipe-meta">
                                    <div class="meta-item">
                                        <i class="bi bi-fire"></i>
                                        <span>{{ recipe.calories }} calories</span>
                                    </div>
                                    <div class="meta-item">
                                        <i class="bi bi-clock"></i>
                                        <span>{{ recipe.cookingTime }} min cooking time</span>
                                    </div>
                                    <div class="meta-item">
                                        <i class="bi bi-clock-history"></i>
                                        <span>{{ recipe.prepTime }} min prep time</span>
                                    </div>
                                </div>
                                <a href="{{ path('app_recipe_show', {'id': recipe.id}) }}" class="btn btn-outline-primary view-recipe-btn">VIEW RECIPE</a>
                            </div>
                        </div>
                    {% endfor %}
                </div>
            </section>
        </div>

    {% else %}
        {# Keep the existing landing page content for non-authenticated users #}
        {{ parent() }}
    {% endif %}
{% endblock %}
